<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Monyet Lighting</title>
  <style>
    body {
      margin: 0;
      background-color: #f0f0f0;
    }

    #canvas {
      border: 1px solid black;
    }
  </style>
</head>

<body>
  <canvas id="canvas" width="1280" height="720"></canvas>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gl-matrix/2.8.1/gl-matrix-min.js"></script>
  <script>
    const createShader = (gl, type, source) => {
      // Create a shader object
      const shader = gl.createShader(type);

      // Set the shader source code
      gl.shaderSource(shader, source);

      // Compile the shader
      gl.compileShader(shader);

      // Check for compilation errors
      if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {
        console.error(`Error compiling shader: ${gl.getShaderInfoLog(shader)}`);
        gl.deleteShader(shader);
        return null;
      }

      return shader;
    }

    const createProgram = (gl, vertexShader, fragmentShader) => {
      // Create a program object
      const program = gl.createProgram();

      // Attach shaders to the program
      gl.attachShader(program, vertexShader);
      gl.attachShader(program, fragmentShader);

      // Link the program
      gl.linkProgram(program);

      // Check for linking errors
      if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {
        console.error(`Error linking program: ${gl.getProgramInfoLog(program)}`);
        gl.deleteProgram(program);
        return null;
      }

      return program;
    }

    const mainFunction = async (response) => {
      var canvas = document.getElementById('canvas');
      var gl = canvas.getContext('webgl2');

      const objText = await response.text();
      const lines = objText.split('\n');

      const vertices = [];
      const faces = [];

      for (const line of lines) {
        const tokens = line.trim().split(/\s+/);
        if (!tokens.length) continue;

        if (tokens[0] === 'v') {
          // Vertex coordinates (x, y, z)
          const [x, y, z] = tokens.slice(1).map(parseFloat);
          vertices.push({ x, y, z });
        } else if (tokens[0] === 'f') {
          // Face indices (assuming triangular faces)
          const [v1, v2, v3] = tokens.slice(1).map((token) => parseInt(token.split('/')[0], 10));
          faces.push({ v1, v2, v3 });
        }
      }
      const model = {
        vertices: vertices, // {x,y,z}
        faces: faces, // {v1,v2,v3}
      }

    }

    fetch("./kera.obj").then(mainFunction)
  </script>
</body>

</html>
<!-- // console.log(model)
// const maxx = {
//   x: Math.max(...model.vertices.map((v) => v.x)),
//   y: Math.max(...model.vertices.map((v) => v.y)),
//   z: Math.max(...model.vertices.map((v) => v.z)),
// }
// const minn = {
//   x: Math.min(...model.vertices.map((v) => v.x)),
//   y: Math.min(...model.vertices.map((v) => v.y)),
//   z: Math.min(...model.vertices.map((v) => v.z)),
// }
// console.log({maxx,minn}) -->